#distribution-show-page
  - total = @distribution.tips.map(&:amount).sum
  %p
    Total amount: #{btc_human total}
  %table.table
    %thead
      %tr
        %th Recipient
        %th Address
        %th Amount
        %th Percentage
    %tbody
      - @distribution.tips.each do |tip|
        %tr
          %td.recipient= "#{tip.user.nickname} (GitHub user)"
          %td.address= tip.user.bitcoin_address
          %td.amount= btc_human tip.amount
          %td.percentage= number_to_percentage(tip.amount.to_f * 100 / total, precision: 1)
  - if @distribution.is_error?
    %p.alert.alert-danger
      The transaction failed.
  - elsif @distribution.sent?
    %p.alert.alert-success
      Transaction sent
      - if @distribution.sent_at
        on #{l(@distribution.sent_at)}
  - elsif !@distribution.all_addresses_known?
    %p.alert.alert-warning
      The transaction cannot be sent because some addresses are missing. Ask the recipients to log in with their GitHub account.
  - elsif can? :send_transaction, @distribution
    = button_to "Send the transaction", send_transaction_project_distribution_path(@project, @distribution), class: "btn btn-primary", data: {confirm: "#{total.to_f / COIN} peercoins will be sent. Are you sure?"}

  - if @distribution.data.present?
    %h4 Raw data
    %pre= @distribution.data
